<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr·∫Øc nghi·ªám H∆∞·ªõng nghi·ªáp RIASEC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 300px;
            padding: 20px;
            gap: 15px;
        }
        .bar-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .bar {
            width: 100%;
            background: linear-gradient(180deg, var(--bar-color) 0%, var(--bar-color-dark) 100%);
            border-radius: 8px 8px 0 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            color: white;
            font-weight: bold;
            padding-bottom: 10px;
        }
        .bar:hover {
            opacity: 0.8;
            transform: translateY(-5px);
        }
        .likert-option {
            transition: all 0.2s ease;
        }
        .likert-option:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const SHEETDB_API_URL = 'https://sheetdb.io/api/v1/l3w3hhxab5liu';

        const state = {
            page: 'intro',
            answers: {},
            results: null,
            loading: false,
            careerGoals: {
                name: '', 
                class: '', 
                career: '', 
                skills: '', 
                oneYearPlan: '', 
                parentEmail: ''
            }
        };

        const questions = [
            { id: 1, text: "T√¥i th√≠ch l√†m vi·ªác v·ªõi m√°y m√≥c, d·ª•ng c·ª•, s·ª≠a ch·ªØa ƒë·ªì v·∫≠t.", category: "R" },
            { id: 2, text: "T√¥i th√≠ch tham gia c√°c ho·∫°t ƒë·ªông ngo√†i tr·ªùi, th·ªÉ thao, k·ªπ thu·∫≠t th·ª±c h√†nh.", category: "R" },
            { id: 3, text: "T√¥i vui khi l·∫Øp r√°p ƒë·ªì ch∆°i, m√¥ h√¨nh, ho·∫∑c s·ª≠a ƒë·ªì trong nh√†.", category: "R" },
            { id: 4, text: "T√¥i h·ª©ng th√∫ v·ªõi ngh·ªÅ nghi·ªáp c·∫ßn k·ªπ nƒÉng th·ª±c h√†nh (th·ª£, k·ªπ s∆∞).", category: "R" },
            { id: 5, text: "T√¥i th√≠ch kh√°m ph√° c√¥ng c·ª• k·ªπ thu·∫≠t m·ªõi (ƒëi·ªán, m√°y, robot).", category: "R" },
            
            { id: 6, text: "T√¥i th√≠ch t√¨m hi·ªÉu nguy√™n nh√¢n c·ªßa c√°c hi·ªán t∆∞·ª£ng t·ª± nhi√™n.", category: "I" },
            { id: 7, text: "T√¥i th√≠ch ƒë·ªçc s√°ch khoa h·ªçc, l√†m th√≠ nghi·ªám nh·ªè ƒë·ªÉ kh√°m ph√°.", category: "I" },
            { id: 8, text: "T√¥i th√≠ch suy nghƒ©, ph√¢n t√≠ch, t√¨m l·ªùi gi·∫£i cho v·∫•n ƒë·ªÅ.", category: "I" },
            { id: 9, text: "T√¥i th√≠ch nghi√™n c·ª©u, ƒë·∫∑t c√¢u h·ªèi 't·∫°i sao' v√† t√¨m b·∫±ng ch·ª©ng.", category: "I" },
            { id: 10, text: "T√¥i t√≤ m√≤ v·ªÅ c√°ch m·ªçi th·ª© ho·∫°t ƒë·ªông v√† mu·ªën t√¨m hi·ªÉu s√¢u h∆°n.", category: "I" },
            
            { id: 11, text: "T√¥i th√≠ch v·∫Ω, l√†m ƒë·ªì th·ªß c√¥ng, thi·∫øt k·∫ø s√°ng t·∫°o.", category: "A" },
            { id: 12, text: "T√¥i c·∫£m th·∫•y vui khi t·∫°o ra b·ª©c tranh, b√†i h√°t ho·∫∑c c√¢u chuy·ªán.", category: "A" },
            { id: 13, text: "T√¥i mu·ªën l√†m nh·ªØng vi·ªác li√™n quan ƒë·∫øn ngh·ªá thu·∫≠t, s√¢n kh·∫•u.", category: "A" },
            { id: 14, text: "T√¥i th√≠ch thi·∫øt k·∫ø trang tr√≠, ph·ªëi m√†u, s√°ng t·∫°o h√¨nh ·∫£nh.", category: "A" },
            { id: 15, text: "T√¥i mu·ªën th·ª≠ l√†m s·∫£n ph·∫©m th·ªß c√¥ng ƒë·ªÉ tr∆∞ng b√†y.", category: "A" },
            
            { id: 16, text: "T√¥i th√≠ch h∆∞·ªõng d·∫´n v√† gi√∫p ƒë·ª° b·∫°n b√® khi h·ªç h·ªçc.", category: "S" },
            { id: 17, text: "T√¥i th√≠ch l√†m vi·ªác nh√≥m ƒë·ªÉ chƒÉm s√≥c, h·ªó tr·ª£ ng∆∞·ªùi kh√°c.", category: "S" },
            { id: 18, text: "T√¥i s·∫µn s√†ng l·∫Øng nghe v√† t∆∞ v·∫•n khi ng∆∞·ªùi kh√°c g·∫∑p kh√≥ khƒÉn.", category: "S" },
            { id: 19, text: "T√¥i th√≠ch tham gia ho·∫°t ƒë·ªông c·ªông ƒë·ªìng, gi√∫p tr·∫ª nh·ªè ho·∫∑c ng∆∞·ªùi gi√†.", category: "S" },
            { id: 20, text: "T√¥i th√≠ch trao ƒë·ªïi, l·∫Øng nghe v√† gi·∫£i b√†i to√°n cu·ªôc s·ªëng c·ªßa ng∆∞·ªùi kh√°c.", category: "S" },
            
            { id: 21, text: "T√¥i th√≠ch thuy·∫øt tr√¨nh, thuy·∫øt ph·ª•c ho·∫∑c t·ªï ch·ª©c s·ª± ki·ªán nh·ªè.", category: "E" },
            { id: 22, text: "T√¥i mu·ªën qu·∫£n l√Ω m·ªôt d·ª± √°n nh·ªè ho·∫∑c b√°n h√†ng khi c√≥ d·ªãp.", category: "E" },
            { id: 23, text: "T√¥i hay c√≥ √Ω t∆∞·ªüng b·∫Øt ƒë·∫ßu m·ªôt ho·∫°t ƒë·ªông ho·∫∑c d·ª± √°n nh·ªè.", category: "E" },
            { id: 24, text: "T√¥i t·ª± tin khi ph·∫£i thuy·∫øt ph·ª•c m·ªçi ng∆∞·ªùi l√†m theo √Ω m√¨nh.", category: "E" },
            { id: 25, text: "T√¥i c√≥ mong mu·ªën th·ª≠ l·∫≠p m·ªôt gian h√†ng ho·∫∑c b√°n s·∫£n ph·∫©m nh·ªè.", category: "E" },
            
            { id: 26, text: "T√¥i th√≠ch l√†m vi·ªác theo quy t·∫Øc, s·∫Øp x·∫øp gi·∫•y t·ªù ho·∫∑c l·∫≠p danh s√°ch.", category: "C" },
            { id: 27, text: "T√¥i c·∫£m th·∫•y an t√¢m khi c√¥ng vi·ªác r√µ r√†ng, c√≥ quy tr√¨nh.", category: "C" },
            { id: 28, text: "T√¥i th√≠ch l√†m c√¥ng vi·ªác c·∫ßn ƒë·ªô ch√≠nh x√°c v√† theo h∆∞·ªõng d·∫´n chi ti·∫øt.", category: "C" },
            { id: 29, text: "T√¥i th√≠ch c√¥ng vi·ªác h√†nh ch√≠nh, s·ªï s√°ch, l∆∞u tr·ªØ t√†i li·ªáu.", category: "C" },
            { id: 30, text: "T√¥i th√≠ch l√†m vi·ªác c√≥ tr√¨nh t·ª±, th·ª±c hi·ªán theo danh s√°ch c√¥ng vi·ªác.", category: "C" }
        ];

        const likertScale = [
            { value: 1, label: "R·∫•t kh√¥ng th√≠ch", color: "from-red-500 to-red-600" },
            { value: 2, label: "Kh√¥ng th√≠ch", color: "from-orange-500 to-orange-600" },
            { value: 3, label: "Trung l·∫≠p", color: "from-gray-500 to-gray-600" },
            { value: 4, label: "Th√≠ch", color: "from-blue-500 to-blue-600" },
            { value: 5, label: "R·∫•t th√≠ch", color: "from-green-500 to-green-600" }
        ];

        const categoryInfo = {
            R: { name: "Realistic - Th·ª±c t·∫ø", shortName: "Th·ª±c t·∫ø", color: "#3B82F6", colorDark: "#2563EB", icon: "üîß", description: "B·∫°n c√≥ kh·∫£ nƒÉng l√†m vi·ªác v·ªõi tay, th√≠ch ho·∫°t ƒë·ªông th·ª±c h√†nh v√† k·ªπ thu·∫≠t." },
            I: { name: "Investigative - Nghi√™n c·ª©u", shortName: "Nghi√™n c·ª©u", color: "#8B5CF6", colorDark: "#7C3AED", icon: "üî¨", description: "B·∫°n th√≠ch suy nghƒ©, ph√¢n t√≠ch v√† t√¨m hi·ªÉu." },
            A: { name: "Artistic - Ngh·ªá thu·∫≠t", shortName: "Ngh·ªá thu·∫≠t", color: "#EC4899", colorDark: "#DB2777", icon: "üé®", description: "B·∫°n c√≥ nƒÉng khi·∫øu s√°ng t·∫°o, th√≠ch ngh·ªá thu·∫≠t v√† thi·∫øt k·∫ø." },
            S: { name: "Social - X√£ h·ªôi", shortName: "X√£ h·ªôi", color: "#10B981", colorDark: "#059669", icon: "üë•", description: "B·∫°n th√≠ch l√†m vi·ªác v·ªõi ng∆∞·ªùi kh√°c, gi√∫p ƒë·ª° v√† h·ªó tr·ª£." },
            E: { name: "Enterprising - Qu·∫£n l√Ω", shortName: "Qu·∫£n l√Ω", color: "#F59E0B", colorDark: "#D97706", icon: "üíº", description: "B·∫°n c√≥ kh·∫£ nƒÉng l√£nh ƒë·∫°o, thuy·∫øt ph·ª•c v√† kinh doanh." },
            C: { name: "Conventional - Quy t·∫Øc", shortName: "Quy t·∫Øc", color: "#6366F1", colorDark: "#4F46E5", icon: "üìã", description: "B·∫°n th√≠ch l√†m vi·ªác c√≥ t·ªï ch·ª©c, theo quy tr√¨nh r√µ r√†ng." }
        };

        const careerCombinations = {
            'RIE': { title: 'K·ªπ s∆∞, Nh√† nghi√™n c·ª©u ·ª©ng d·ª•ng', desc: 'Ph√π h·ª£p: K·ªπ s∆∞ c∆° kh√≠, K·ªπ s∆∞ ƒëi·ªán, Nh√† ph√°t tri·ªÉn c√¥ng ngh·ªá' },
            'RIC': { title: 'K·ªπ thu·∫≠t vi√™n chuy√™n m√¥n', desc: 'Ph√π h·ª£p: K·ªπ thu·∫≠t vi√™n y t·∫ø, Ki·ªÉm ƒë·ªãnh vi√™n, K·ªπ thu·∫≠t x√¢y d·ª±ng' },
            'RAE': { title: 'Thi·∫øt k·∫ø & Ch·∫ø t√°c', desc: 'Ph√π h·ª£p: Ki·∫øn tr√∫c s∆∞, Nh√† thi·∫øt k·∫ø c√¥ng nghi·ªáp, Th·ª£ th·ªß c√¥ng cao c·∫•p' },
            'IRE': { title: 'Nghi√™n c·ª©u khoa h·ªçc ·ª©ng d·ª•ng', desc: 'Ph√π h·ª£p: Nh√† khoa h·ªçc d·ªØ li·ªáu, L·∫≠p tr√¨nh vi√™n, Nh√† ph√¢n t√≠ch h·ªá th·ªëng' },
            'IAE': { title: 'Nghi√™n c·ª©u & S√°ng t·∫°o', desc: 'Ph√π h·ª£p: Nh√† khoa h·ªçc x√£ h·ªôi, Nh√† nghi√™n c·ª©u th·ªã tr∆∞·ªùng, Designer UX/UI' },
            'IAS': { title: 'Khoa h·ªçc x√£ h·ªôi & Gi√°o d·ª•c', desc: 'Ph√π h·ª£p: Nh√† t√¢m l√Ω h·ªçc, Nh√† nghi√™n c·ª©u gi√°o d·ª•c, Chuy√™n gia ph√°t tri·ªÉn' },
            'ISE': { title: 'Y t·∫ø & T∆∞ v·∫•n', desc: 'Ph√π h·ª£p: B√°c sƒ©, D∆∞·ª£c sƒ©, Chuy√™n vi√™n y t·∫ø c·ªông ƒë·ªìng' },
            'AEI': { title: 'S√°ng t·∫°o n·ªôi dung & Marketing', desc: 'Ph√π h·ª£p: Content creator, Marketing, Nh√† thi·∫øt k·∫ø qu·∫£ng c√°o' },
            'AES': { title: 'Ngh·ªá thu·∫≠t bi·ªÉu di·ªÖn & Gi·∫£ng d·∫°y', desc: 'Ph√π h·ª£p: Ngh·ªá sƒ©, Di·ªÖn vi√™n, Gi√°o vi√™n ngh·ªá thu·∫≠t' },
            'ASE': { title: 'Truy·ªÅn th√¥ng & Quan h·ªá c√¥ng ch√∫ng', desc: 'Ph√π h·ª£p: Nh√† b√°o, MC, Chuy√™n vi√™n PR' },
            'SEI': { title: 'Qu·∫£n l√Ω ngu·ªìn nh√¢n l·ª±c', desc: 'Ph√π h·ª£p: HR Manager, Chuy√™n vi√™n ƒë√†o t·∫°o, T∆∞ v·∫•n ph√°t tri·ªÉn' },
            'SEA': { title: 'Gi√°o d·ª•c & ƒê√†o t·∫°o', desc: 'Ph√π h·ª£p: Gi√°o vi√™n, Gi·∫£ng vi√™n, Chuy√™n vi√™n ƒë√†o t·∫°o doanh nghi·ªáp' },
            'SAI': { title: 'ChƒÉm s√≥c s·ª©c kh·ªèe c·ªông ƒë·ªìng', desc: 'Ph√π h·ª£p: Y t√°, Nh√¢n vi√™n x√£ h·ªôi, T∆∞ v·∫•n t√¢m l√Ω' },
            'EIR': { title: 'Qu·∫£n l√Ω d·ª± √°n c√¥ng ngh·ªá', desc: 'Ph√π h·ª£p: Project Manager IT, Gi√°m ƒë·ªëc c√¥ng ngh·ªá, Business Analyst' },
            'EIS': { title: 'T∆∞ v·∫•n & Ph√°t tri·ªÉn kinh doanh', desc: 'Ph√π h·ª£p: T∆∞ v·∫•n qu·∫£n l√Ω, Business Developer, Sales Manager' },
            'EAS': { title: 'Kinh doanh & Marketing s√°ng t·∫°o', desc: 'Ph√π h·ª£p: Marketing Director, Event Manager, Brand Manager' },
            'ECS': { title: 'Qu·∫£n tr·ªã kinh doanh', desc: 'Ph√π h·ª£p: Qu·∫£n l√Ω doanh nghi·ªáp, CEO, Gi√°m ƒë·ªëc ƒëi·ªÅu h√†nh' },
            'CER': { title: 'Qu·∫£n l√Ω v·∫≠n h√†nh', desc: 'Ph√π h·ª£p: Qu·∫£n l√Ω s·∫£n xu·∫•t, Logistics Manager, Supply Chain' },
            'CEI': { title: 'Qu·∫£n l√Ω t√†i ch√≠nh', desc: 'Ph√π h·ª£p: K·∫ø to√°n tr∆∞·ªüng, Ph√¢n t√≠ch t√†i ch√≠nh, Ki·ªÉm to√°n vi√™n' },
            'CSE': { title: 'H√†nh ch√≠nh & Qu·∫£n l√Ω vƒÉn ph√≤ng', desc: 'Ph√π h·ª£p: Tr·ª£ l√Ω gi√°m ƒë·ªëc, Office Manager, Th∆∞ k√Ω' },
            'CIE': { title: 'Ph√¢n t√≠ch d·ªØ li·ªáu & Th·ªëng k√™', desc: 'Ph√π h·ª£p: Data Analyst, Chuy√™n vi√™n th·ªëng k√™, QA/QC' }
        };

        function handleAnswer(questionId, value) {
            state.answers[questionId] = value;
            render();
        }

        function updateCareerGoal(field, value) {
            state.careerGoals[field] = value;
            render();
        }

        function calculateResults() {
            const scores = { R: 0, I: 0, A: 0, S: 0, E: 0, C: 0 };
            const maxScores = { R: 25, I: 25, A: 25, S: 25, E: 25, C: 25 };
            
            questions.forEach(q => { 
                if (state.answers[q.id]) {
                    scores[q.category] += state.answers[q.id];
                }
            });

            const percentageScores = {};
            Object.keys(scores).forEach(key => {
                percentageScores[key] = Math.round((scores[key] / maxScores[key]) * 100);
            });

            const chartData = Object.entries(scores).map(([key, value]) => ({
                category: key,
                name: categoryInfo[key].shortName,
                score: value,
                percentage: percentageScores[key],
                color: categoryInfo[key].color,
                colorDark: categoryInfo[key].colorDark
            }));

            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const top3 = sortedScores.slice(0, 3);
            const riasecCode = top3.map(item => item[0]).join('');
            
            const careerMatch = careerCombinations[riasecCode] || careerCombinations[riasecCode.substring(0,2) + sortedScores[3][0]] || null;

            state.results = { 
                scores: scores,
                percentageScores: percentageScores,
                chartData: chartData,
                topCategory: sortedScores[0][0], 
                topScore: sortedScores[0][1],
                top3Categories: top3,
                riasecCode: riasecCode,
                careerMatch: careerMatch,
                sortedScores: sortedScores 
            };
            state.page = 'results';
            render();
        }

        async function saveToGoogleSheets(data, sheetName) {
            if (SHEETDB_API_URL === 'YOUR_SHEETDB_API_URL') {
                console.warn('Ch∆∞a c·∫•u h√¨nh API');
                return false;
            }
            try {
                state.loading = true;
                render();
                const url = SHEETDB_API_URL + '?sheet=' + sheetName;
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data: [data] })
                });
                if (!response.ok) throw new Error('Failed');
                return true;
            } catch (error) {
                console.error('Error:', error);
                alert('C√≥ l·ªói x·∫£y ra!');
                return false;
            } finally {
                state.loading = false;
                render();
            }
        }

        async function handleGoalSubmit() {
            const timestamp = new Date().toLocaleString('vi-VN');
            const testData = {
                Timestamp: timestamp,
                Name: state.careerGoals.name,
                Class: state.careerGoals.class,
                R: state.results.scores.R,
                I: state.results.scores.I,
                A: state.results.scores.A,
                S: state.results.scores.S,
                E: state.results.scores.E,
                C: state.results.scores.C,
                RIASECCode: state.results.riasecCode,
                TopCategory: categoryInfo[state.results.topCategory].name,
                CareerMatch: state.results.careerMatch ? state.results.careerMatch.title : ''
            };
            const goalsData = {
                Timestamp: timestamp,
                Name: state.careerGoals.name,
                Class: state.careerGoals.class,
                Career: state.careerGoals.career,
                Skills: state.careerGoals.skills,
                OneYearPlan: state.careerGoals.oneYearPlan,
                ParentEmail: state.careerGoals.parentEmail || 'Kh√¥ng c√≥'
            };

            const testSaved = await saveToGoogleSheets(testData, 'Test Results');
            const goalsSaved = await saveToGoogleSheets(goalsData, 'Career Goals');

            if (testSaved && goalsSaved) {
                alert('‚úÖ ƒê√£ l∆∞u th√†nh c√¥ng!');
                state.page = 'intro';
                state.answers = {};
                state.results = null;
                state.careerGoals = { name: '', class: '', career: '', skills: '', oneYearPlan: '', parentEmail: '' };
                render();
            }
        }

        function isAllAnswered() {
            return questions.every(q => state.answers[q.id] !== undefined);
        }

        function isFormValid() {
            return state.careerGoals.name && state.careerGoals.class && state.careerGoals.career && state.careerGoals.skills && state.careerGoals.oneYearPlan;
        }

        function render() {
            const root = document.getElementById('root');
            
            if (state.page === 'intro') {
                root.innerHTML = `
                    <div class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 relative overflow-hidden">
                        <div class="absolute inset-0">
                            <div class="absolute top-20 left-10 w-72 h-72 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse"></div>
                        </div>
                        <div class="relative z-10 min-h-screen flex items-center justify-center p-4">
                            <div class="max-w-4xl w-full">
                                <div class="text-center mb-12">
                                    <h1 class="text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400 mb-4">RIASEC</h1>
                                    <h2 class="text-2xl md:text-3xl font-bold text-white mb-3">Tr·∫Øc nghi·ªám H∆∞·ªõng nghi·ªáp</h2>
                                    <p class="text-xl text-purple-200 mb-6">Kh√°m ph√° con ƒë∆∞·ªùng s·ª± nghi·ªáp c·ªßa b·∫°n</p>
                                    <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 max-w-2xl mx-auto">
                                        <p class="text-white text-sm">
                                            ‚≠ê ƒê√°nh gi√° m·ª©c ƒë·ªô y√™u th√≠ch c·ªßa b·∫°n v·ªõi m·ªói ho·∫°t ƒë·ªông<br>
                                            üìä H·ªá th·ªëng s·∫Ω ph√¢n t√≠ch v√† ƒë∆∞a ra ƒë·ªãnh h∆∞·ªõng ngh·ªÅ nghi·ªáp ph√π h·ª£p
                                        </p>
                                    </div>
                                </div>
                                <div class="bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 p-8">
                                    <button onclick="state.page='test'; render();" class="w-full bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 hover:from-purple-600 hover:via-pink-600 hover:to-blue-600 text-white font-bold py-5 px-8 rounded-2xl text-xl transition-all shadow-2xl">
                                        B·∫Øt ƒë·∫ßu kh√°m ph√° ‚Üí
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.page === 'test') {
                const progress = (Object.keys(state.answers).length / questions.length) * 100;
                const questionsHTML = questions.map(q => {
                    const isAnswered = state.answers[q.id] !== undefined;
                    const cardClass = 'bg-white/10 backdrop-blur-xl rounded-2xl border p-6 transition-all ' + (isAnswered ? 'border-green-400/50 shadow-lg' : 'border-white/20');
                    
                    const optionsHTML = likertScale.map(option => {
                        const isSelected = state.answers[q.id] === option.value;
                        const btnClass = 'likert-option flex-1 py-3 px-2 rounded-xl font-semibold text-sm transition-all ' + 
                            (isSelected ? 'bg-gradient-to-r ' + option.color + ' text-white shadow-lg scale-105' : 'bg-white/10 text-white hover:bg-white/20 border border-white/20');
                        
                        return `
                            <button onclick="handleAnswer(${q.id}, ${option.value})" class="${btnClass}" title="${option.label}">
                                ${option.value}
                            </button>
                        `;
                    }).join('');
                    
                    return `
                        <div class="${cardClass}">
                            <p class="text-white font-medium mb-4">
                                <span class="text-purple-400 font-bold">C√¢u ${q.id}:</span> ${q.text}
                            </p>
                            <div class="mb-3">
                                <div class="flex justify-between text-xs text-purple-200 mb-2">
                                    <span>R·∫•t kh√¥ng th√≠ch</span>
                                    <span>R·∫•t th√≠ch</span>
                                </div>
                                <div class="flex gap-2">
                                    ${optionsHTML}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                root.innerHTML = `
                    <div class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4 py-8">
                        <div class="max-w-4xl mx-auto">
                            <div class="bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 p-6 mb-6 sticky top-4 z-10">
                                <div class="flex items-center justify-between mb-4">
                                    <h2 class="text-2xl font-bold text-white">B√†i tr·∫Øc nghi·ªám</h2>
                                    <div class="text-right">
                                        <div class="text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400">
                                            ${Object.keys(state.answers).length}/${questions.length}
                                        </div>
                                    </div>
                                </div>
                                <div class="w-full bg-white/10 rounded-full h-3">
                                    <div class="h-3 bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 rounded-full transition-all" style="width: ${progress}%"></div>
                                </div>
                                <p class="text-center text-purple-200 text-sm mt-2">${progress.toFixed(0)}% ho√†n th√†nh</p>
                            </div>
                            <div class="space-y-4">
                                ${questionsHTML}
                            </div>
                            <div class="sticky bottom-4 mt-8">
                                <button 
                                    onclick="${isAllAnswered() ? 'calculateResults()' : ''}" 
                                    ${!isAllAnswered() ? 'disabled' : ''}
                                    class="w-full py-5 rounded-2xl text-xl font-bold flex items-center justify-center gap-3 ${isAllAnswered() ? 'bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 text-white shadow-2xl cursor-pointer hover:scale-105 transition-all' : 'bg-white/10 text-gray-400 cursor-not-allowed'}"
                                >
                                    ${isAllAnswered() ? '‚ú® Xem k·∫øt qu·∫£' : '‚è≥ Vui l√≤ng tr·∫£ l·ªùi t·∫•t c·∫£ c√¢u h·ªèi'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.page === 'results') {
                const barsHTML = state.results.chartData.map(item => `
                    <div class="bar-item">
                        <div class="bar" style="--bar-color: ${item.color}; --bar-color-dark: ${item.colorDark}; height: ${(item.percentage)}%;">
                            ${item.score}
                        </div>
                        <div class="text-center">
                            <div class="text-white text-sm font-semibold">${item.name}</div>
                            <div class="text-purple-200 text-xs">${item.percentage}%</div>
                        </div>
                    </div>
                `).join('');

                const top3HTML = state.results.top3Categories.map((item, idx) => {
                    const cat = item[0];
                    const score = item[1];
                    const badge = idx === 0 ? 'ü•á' : idx === 1 ? 'ü•à' : 'ü•â';
                    return `
                        <div class="bg-white/5 rounded-xl p-4 border border-white/10">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="text-3xl">${badge}</span>
                                <div>
                                    <div class="text-white font-bold">${categoryInfo[cat].shortName}</div>
                                    <div class="text-purple-200 text-sm">${score}/25 ƒëi·ªÉm (${state.results.percentageScores[cat]}%)</div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                const careerMatchHTML = state.results.careerMatch ? `
                    <div class="bg-gradient-to-r from-yellow-500/20 to-orange-500/20 backdrop-blur-xl rounded-3xl border border-yellow-400/30 p-8 mb-8">
                        <div class="flex items-start gap-4">
                            <div class="text-5xl">üéØ</div>
                            <div class="flex-1">
                                <h4 class="text-2xl font-bold text-white mb-3">ƒê·ªãnh h∆∞·ªõng ngh·ªÅ nghi·ªáp c·ªßa b·∫°n</h4>
                                <div class="bg-white/10 rounded-xl p-4 mb-4">
                                    <div class="text-yellow-300 font-bold text-lg mb-2">M√£ RIASEC: ${state.results.riasecCode}</div>
                                    <div class="text-white text-xl font-bold mb-2">${state.results.careerMatch.title}</div>
                                    <div class="text-purple-100">${state.results.careerMatch.desc}</div>
                                </div>
                                <p class="text-white leading-relaxed">
                                    T·ªï h·ª£p t√≠nh c√°ch <strong class="text-yellow-300">${state.results.riasecCode}</strong> c·ªßa b·∫°n cho th·∫•y b·∫°n ph√π h·ª£p v·ªõi nh√≥m ng√†nh ngh·ªÅ tr√™n. 
                                    H√£y t√¨m hi·ªÉu th√™m v√† r√®n luy·ªán c√°c k·ªπ nƒÉng c·∫ßn thi·∫øt ƒë·ªÉ ph√°t tri·ªÉn trong lƒ©nh v·ª±c n√†y!
                                </p>
                            </div>
                        </div>
                    </div>
                ` : '';

                root.innerHTML = `
                    <div class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4 py-8">
                        <div class="max-w-6xl mx-auto">
                            <div class="text-center mb-10">
                                <h2 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400 mb-2">K·∫øt qu·∫£ c·ªßa b·∫°n</h2>
                                <p class="text-purple-200">Ph√¢n t√≠ch t√≠nh c√°ch v√† ƒë·ªãnh h∆∞·ªõng ngh·ªÅ nghi·ªáp</p>
                            </div>

                            <div class="bg-gradient-to-br from-purple-500/20 via-pink-500/20 to-blue-500/20 backdrop-blur-xl rounded-3xl border border-purple-400/30 p-8 mb-8">
                                <div class="text-center mb-6">
                                    <div class="text-6xl mb-4">${categoryInfo[state.results.topCategory].icon}</div>
                                    <h3 class="text-3xl font-black text-white mb-2">${categoryInfo[state.results.topCategory].name}</h3>
                                    <div class="inline-block bg-white/20 rounded-full px-6 py-2">
                                        <span class="text-2xl font-bold text-white">${state.results.topScore}/25 ƒëi·ªÉm (${state.results.percentageScores[state.results.topCategory]}%)</span>
                                    </div>
                                </div>
                                <p class="text-white text-lg text-center mb-6">${categoryInfo[state.results.topCategory].description}</p>
                                
                                <div class="bg-white/10 rounded-2xl p-6">
                                    <h4 class="text-purple-200 font-semibold text-center mb-4">Top 3 nh√≥m t√≠nh c√°ch c·ªßa b·∫°n:</h4>
                                    <div class="grid md:grid-cols-3 gap-4">
                                        ${top3HTML}
                                    </div>
                                </div>
                            </div>

                            ${careerMatchHTML}

                            <div class="bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 p-6 mb-8">
                                <h3 class="text-xl font-bold text-white mb-6 text-center">üìä Bi·ªÉu ƒë·ªì ph√¢n t√≠ch chi ti·∫øt</h3>
                                <div class="bar-chart">
                                    ${barsHTML}
                                </div>
                                <div class="mt-6 text-center text-purple-200 text-sm">
                                    ƒêi·ªÉm s·ªë t·ªëi ƒëa m·ªói nh√≥m: 25 ƒëi·ªÉm (5 c√¢u √ó 5 ƒëi·ªÉm)
                                </div>
                            </div>

                            <div class="bg-gradient-to-r from-blue-500/20 to-cyan-500/20 backdrop-blur-xl rounded-3xl border border-blue-400/30 p-8 mb-8">
                                <div class="flex items-start gap-4">
                                    <div class="text-4xl">üí°</div>
                                    <div class="flex-1">
                                        <h4 class="text-2xl font-bold text-white mb-3">L·ªùi khuy√™n t·ª´ chuy√™n gia</h4>
                                        <p class="text-white leading-relaxed text-lg">
                                            K·∫øt qu·∫£ tr·∫Øc nghi·ªám cho th·∫•y ƒëi·ªÉm m·∫°nh c·ªßa b·∫°n thu·ªôc nh√≥m <strong class="text-blue-300">${categoryInfo[state.results.topCategory].name}</strong>. 
                                            T·ªï h·ª£p <strong class="text-blue-300">${state.results.riasecCode}</strong> c·ªßa b·∫°n ƒë·∫∑c bi·ªát ph√π h·ª£p v·ªõi c√°c ngh·ªÅ nghi·ªáp k·∫øt h·ª£p gi·ªØa ${state.results.top3Categories.map(item => categoryInfo[item[0]].shortName.toLowerCase()).join(', ')}.
                                            H√£y t√¨m hi·ªÉu th√™m v·ªÅ c√°c ngh·ªÅ nghi·ªáp n√†y v√† b·∫Øt ƒë·∫ßu r√®n luy·ªán c√°c k·ªπ nƒÉng c·∫ßn thi·∫øt t·ª´ b√¢y gi·ªù!
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <button onclick="state.page='goals'; render();" class="w-full bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 hover:from-purple-600 hover:via-pink-600 hover:to-blue-600 text-white font-bold py-5 rounded-2xl text-xl shadow-2xl transition-all hover:scale-105">
                                üéØ L·∫≠p m·ª•c ti√™u ngh·ªÅ nghi·ªáp ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            } else if (state.page === 'goals') {
                const btnClass = 'w-full py-5 rounded-2xl text-xl font-bold flex items-center justify-center gap-3 transition-all ' + (isFormValid() && !state.loading ? 'bg-gradient-to-r from-green-500 via-emerald-500 to-teal-500 text-white shadow-2xl cursor-pointer hover:scale-105' : 'bg-white/10 text-gray-400 cursor-not-allowed');
                
                root.innerHTML = `
                    <div class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4 py-8">
                        <div class="max-w-3xl mx-auto">
                            <div class="text-center mb-10">
                                <h2 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-green-400 via-emerald-400 to-teal-400 mb-2">M·ª•c ti√™u c·ªßa t√¥i</h2>
                                <p class="text-purple-200">L·∫≠p k·∫ø ho·∫°ch ph√°t tri·ªÉn ngh·ªÅ nghi·ªáp</p>
                            </div>
                            <div class="bg-white/10 backdrop-blur-xl rounded-3xl border border-white/20 p-8 mb-6 space-y-6">
                                <div>
                                    <label class="block text-white font-bold mb-3">üë§ H·ªç v√† t√™n <span class="text-pink-400">*</span></label>
                                    <input type="text" value="${state.careerGoals.name}" oninput="updateCareerGoal('name', this.value)" class="w-full px-5 py-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-purple-300 focus:ring-2 focus:ring-purple-500 focus:outline-none" placeholder="Nh·∫≠p h·ªç t√™n c·ªßa b·∫°n" />
                                </div>
                                <div>
                                    <label class="block text-white font-bold mb-3">üè´ L·ªõp <span class="text-pink-400">*</span></label>
                                    <input type="text" value="${state.careerGoals.class}" oninput="updateCareerGoal('class', this.value)" class="w-full px-5 py-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-purple-300 focus:ring-2 focus:ring-purple-500 focus:outline-none" placeholder="V√≠ d·ª•: 9A1" />
                                </div>
                                <div>
                                    <label class="block text-white font-bold mb-3">üíº Ngh·ªÅ/nh√≥m ngh·ªÅ b·∫°n h∆∞·ªõng t·ªõi <span class="text-pink-400">*</span></label>
                                    <input type="text" value="${state.careerGoals.career}" oninput="updateCareerGoal('career', this.value)" class="w-full px-5 py-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-purple-300 focus:ring-2 focus:ring-purple-500 focus:outline-none" placeholder="V√≠ d·ª•: K·ªπ s∆∞ ph·∫ßn m·ªÅm, Gi√°o vi√™n..." />
                                </div>
                                <div>
                                    <label class="block text-white font-bold mb-3">üéØ K·ªπ nƒÉng c·∫ßn r√®n luy·ªán <span class="text-pink-400">*</span></label>
                                    <input type="text" value="${state.careerGoals.skills}" oninput="updateCareerGoal('skills', this.value)" class="w-full px-5 py-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-purple-300 focus:ring-2 focus:ring-purple-500 focus:outline-none" placeholder="V√≠ d·ª•: Ti·∫øng Anh, L·∫≠p tr√¨nh, Giao ti·∫øp..." />
                                </div>
                                <div>
                                    <label class="block text-white font-bold mb-3">üìÖ K·∫ø ho·∫°ch h√†nh ƒë·ªông trong 1 nƒÉm t·ªõi <span class="text-pink-400">*</span></label>
                                    <textarea oninput="updateCareerGoal('oneYearPlan', this.value)" rows="5" class="w-full px-5 py-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-purple-300 resize-none focus:ring-2 focus:ring-purple-500 focus:outline-none" placeholder="M√¥ t·∫£ chi ti·∫øt c√°c b∆∞·ªõc b·∫°n s·∫Ω th·ª±c hi·ªán...">${state.careerGoals.oneYearPlan}</textarea>
                                </div>
                                <div>
                                    <label class="block text-white font-bold mb-3">üìß Email li√™n h·ªá ph·ª• huynh</label>
                                    <input type="email" value="${state.careerGoals.parentEmail}" oninput="updateCareerGoal('parentEmail', this.value)" class="w-full px-5 py-4 bg-white/10 border border-white/20 rounded-xl text-white placeholder-purple-300 focus:ring-2 focus:ring-purple-500 focus:outline-none" placeholder="email@example.com (kh√¥ng b·∫Øt bu·ªôc)" />
                                </div>
                            </div>
                            <button onclick="${isFormValid() && !state.loading ? 'handleGoalSubmit()' : ''}" ${!isFormValid() || state.loading ? 'disabled' : ''} class="${btnClass}">
                                ${state.loading ? '‚è≥ ƒêang l∆∞u d·ªØ li·ªáu...' : isFormValid() ? '‚úÖ Ho√†n th√†nh v√† g·ª≠i' : '‚ö†Ô∏è Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc'}
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        render();
    </script>
</body>
</html>